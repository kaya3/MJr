# MJr-compiler

MJr is a probabilistic programming language based on pattern-rewriting, heavily inspired by [MarkovJunior](https://github.com/mxgmn/MarkovJunior) by Maxim Gumin. This project provides a compiler for the MJr programming language, which compiles MJr programs to JavaScript, TypeScript or Python 3.

## Examples

- [Basic.mjr](https://kaya3.github.io/MJr/playground/#IyBUcmFuc2xhdGVkIGZyb20gTWF4aW0gR3VtaW4ncyAnQmFzaWMnIG1vZGVsCiMgaHR0cHM6Ly9naXRodWIuY29tL214Z21uL01hcmtvdkp1bmlvci9ibG9iL21haW4vbW9kZWxzL0Jhc2ljLnhtbAoKZ3JpZCBbQlddCm9uZTogW0JdIC0+IFtXXQo=,JavaScript,1,1,17,17,0): the simplest MJr program that does anything. Hello, World!
- [Backtracker.mjr](https://kaya3.github.io/MJr/playground/#IyBUcmFuc2xhdGVkIGZyb20gTWF4aW0gR3VtaW4ncyAnQmFja3RyYWNrZXInIG1vZGVsCiMgaHR0cHM6Ly9naXRodWIuY29tL214Z21uL01hcmtvdkp1bmlvci9ibG9iL21haW4vbW9kZWxzL0JhY2t0cmFja2VyLnhtbAoKZ3JpZCBbQlJXVV0KCnB1dCBbUl0gYXQgb3JpZ2luCgptYXJrb3Y6CiAgICBvbmU6IFtSQl0gLT4gW1dSXQogICAgb25lOiBbUlddIC0+IFtVUl0K,JavaScript,1,1,17,17,0): generates connected cave systems with pools, using only two rewrite rules.
- [BacktrackerCycle.mjr](https://kaya3.github.io/MJr/playground/#IyBUcmFuc2xhdGVkIGZyb20gTWF4aW0gR3VtaW4ncyAnQmFja3RyYWNrZXJDeWNsZScgbW9kZWwKIyBodHRwczovL2dpdGh1Yi5jb20vbXhnbW4vTWFya292SnVuaW9yL2Jsb2IvbWFpbi9tb2RlbHMvQmFja3RyYWNrZXJDeWNsZS54bWwKCmdyaWQgW0JSR1dBXQoKcHV0IFtSXSBhdCBvcmlnaW4KCm1hcmtvdjoKICAgIG9uZTogW1JCQl0gLT4gW0dHUl0KICAgIG9uZTogW1JHR10gLT4gW1dBUl0KCm9uY2U6IFtSXSAtPiBbV10Kb25jZTogW1dCV10gLT4gW1dBV10KYWxsOiBbQV0gLT4gW1ddCmFsbDogW0JCQi9CV0JdIC0+IFsuLi4vLkIuXQo=,JavaScript,1,1,19,19,0): generates a random cycle.
- [River.mjr](https://kaya3.github.io/MJr/playground/#IyBUcmFuc2xhdGVkIGZyb20gTWF4aW0gR3VtaW4ncyAnUml2ZXInIG1vZGVsCiMgaHR0cHM6Ly9naXRodWIuY29tL214Z21uL01hcmtvdkp1bmlvci9ibG9iL21haW4vbW9kZWxzL1JpdmVyLnhtbAoKZ3JpZCBbQldSVUdFXQoKb25jZTogW0JdIC0+IFtXXQpvbmNlOiBbQl0gLT4gW1JdCgpvbmU6CiAgICBbUkJdIC0+IFtSUl0KICAgIFtXQl0gLT4gW1dXXQoKYWxsOiBbUlddIC0+IFtVVV0KYWxsOiBbW1dSXV0gLT4gW0JdCgpAbGltaXQgMQphbGw6IFtVQl0gLT4gW1VVXQoKYWxsOiBbQlUvVUJdIC0+IFtVLi8uLl0KYWxsOiBbVUJdIC0+IFsuR10KCkBsaW1pdCAxMwpvbmU6IFtCXSAtPiBbRV0KCm9uZToKICAgIFtFQl0gLT4gWy5FXQogICAgW0dCXSAtPiBbLkddCg==,JavaScript,1,1,128,128,5): generates a river with grass growing around it.
- [BasicSnake.mjr](https://kaya3.github.io/MJr/playground/#IyBUcmFuc2xhdGVkIGZyb20gTWF4aW0gR3VtaW4ncyAnQmFzaWNTbmFrZScgbW9kZWwKIyBodHRwczovL2dpdGh1Yi5jb20vbXhnbW4vTWFya292SnVuaW9yL2Jsb2IvbWFpbi9tb2RlbHMvQmFzaWNTbmFrZS54bWwKCmdyaWQgW0JXRFBHUl0KCnB1dCBbV10gYXQgb3JpZ2luCgphbGw6IFtbV0RdQkJdIC0+IFsuLkRdCgpvbmNlOiBbV0JEXSAtPiBbUEdSXQoKQGxpbWl0IDIKb25lOiBbUkJEXSAtPiBbR0dSXQoKQGxpbWl0IDE1Cm9uZTogW0RdIC0+IFtXXQoKbWFya292OgogICAgb25lOiBbUkJXXSAtPiBbR0dSXQogICAgYWxsOgogICAgICAgIFtSQkRdIC0+IFtHR1JdCiAgICAgICAgW1BHR10gLT4gW0RCUF0gaWYgY291bnQgW1JCRF0gPiAwCg==,JavaScript,1,1,31,31,-1): plays a classic game of *Snake*, albeit not very well.
- [BasicDungeonGrowth.mjr](https://kaya3.github.io/MJr/playground/#IyBUcmFuc2xhdGVkIGZyb20gTWF4aW0gR3VtaW4ncyAnQmFzaWNEdW5nZW9uR3Jvd3RoJyBtb2RlbAojIGh0dHBzOi8vZ2l0aHViLmNvbS9teGdtbi9NYXJrb3ZKdW5pb3IvYmxvYi9tYWluL21vZGVscy9CYXNpY0R1bmdlb25Hcm93dGgueG1sCgpncmlkIFtCUkFDREddCnVuaW9uIFs/XSA9IFtbQlJdXQoKcHV0IFtSXSBhdCBvcmlnaW4KCm9uZTogWy4uPy4uLy5CQkIuLy5CQkI/Ly5CQkIuLy4uUi4uXSAtPiBbQUFSQUEvQUREREEvQURERFIvQUREREEvQUFDQUFdCm9uZTogW0FDQS9CQkJdIC0+IFtBUkEvQkJCXQoKYWxsOiBbQ10gLT4gW0RdCmFsbDogW1JdIC0+IFtEXQoKYWxsOiBbQkRdIC0+IFsuQV0KYWxsOiBbREREL0FEQS9ERERdIC0+IFsuLi4vRC5ELy4uLl0KYWxsOiBbREREL0RBRC9ERERdIC0+IFsuLi4vLkQuLy4uLl0K,JavaScript,1,1,47,47,-2): builds a connected dungeon with rooms and corridors.
- [MazesAndLakes.mjr](https://kaya3.github.io/MJr/playground/#IyBBdXRob3I6IEFuZHJldyBLYXkKCnVzZSBsZXQgZyA9IGdyaWQgW0JXUkVJXQoKbGV0IExBS0VfU0VFRFMgPSA0CmxldCBMQUtFX1NJWkUgPSBnLndpZHRoICogZy5oZWlnaHQgLy8gNApsZXQgTEFORF9TRUVEUyA9IDMyCmxldCBBTklNQVRFX1dBVEVSID0gdHJ1ZQoKIyBtYWtlIGEgZmV3IGxha2VzIGJ5IHJhbmRvbSBncm93dGgKQGxpbWl0IExBS0VfU0VFRFMKb25lOiBbQl0gLT4gW0ldCgpAbGltaXQgTEFLRV9TSVpFIC0gTEFLRV9TRUVEUwpvbmU6IFtJQl0gLT4gWy5JXQoKIyBtYWtlIHNvbWUgbGFuZCBieSBhIHNlbGYtYXZvaWRpbmcgcmFuZG9tIHdhbGsgd2l0aCBiYWNrdHJhY2tpbmcKQGxpbWl0IExBTkRfU0VFRFMKb25lOiBbQl0gLT4gW1JdCgptYXJrb3Y6CiAgICBvbmU6IFtSQkJdIC0+IFtXV1JdCiAgICBvbmU6IFtSV1ddIC0+IFtFRVJdCgpvbmU6IFtSXSAtPiBbRV0KCiMgZXJvZGUgbmFycm93IHNlY3Rpb25zIG9mIGxhbmQKb25lOiBbQkJXQkJdIC0+IFsuLkIuLl0KCiMgcmVwbGFjZSB0aGUgc29saWQgbGFrZXMgd2l0aCBpc29sYXRlZCBwaXhlbHMKQGxpbWl0IExBS0VfU0laRSAvLyAyCm9uZTogW0lJXSAtPiBbQkJdCgptYXJrb3Y6CiAgICAjIGZpbGwgdW51c2VkIHNwYWNlIHdpdGggYSB3YXRlciB0ZXh0dXJlCiAgICBvbmU6CiAgICAgICAgW0JCLi9CQkIvLkIuXSAtPiBbLi4uLy5JLi8uLi5dCiAgICAgICAgWy5JLi9JQkkvLkkuXSAtPiBbLi4uLy5JLi8uLi5dCgogICAgIyBkZWxldGUgd2F0ZXIgcGl4ZWxzIGF0IHJhbmRvbSwgZm9yIGFuIGFuaW1hdGVkIGVmZmVjdAogICAgb25lOiBbSV0gLT4gW0JdIGlmIEFOSU1BVEVfV0FURVIK,JavaScript,1,1,256,256,5): generates a weird landscape of cities, forests and lakes.

## Documentation

See the [documentation](doc/) and [implementation notes](notes/) for more information.
